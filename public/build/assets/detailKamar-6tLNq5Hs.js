import{r as m,u as Y,j as e,a as Z}from"./app-O3Ot-Fsy.js";import{A as ee}from"./admin-BCcZ_3Ej.js";import{A as w}from"./avatar.esm-BotAUdfW.js";import{B as n}from"./button.esm-B9-jB2sE.js";import{D as ae,C as u}from"./datatable.esm-DGOvZqNL.js";import{C as se,c as k}from"./confirmdialog.esm-DO3k2vSc.js";import{D as v}from"./dialog.esm-CWqcOpqm.js";import{D as te}from"./dropdown.esm-DvC5BaR3.js";import{I as le}from"./inputtext.esm-CpgFdPdI.js";import{T as ne}from"./tag.esm-B6Gu1wpz.js";import{A as ie}from"./arrow-left-CxUcwPl9.js";import{P as re,T as de}from"./trash-2-BuE7T2tA.js";import{U as oe}from"./users-Bg6501hZ.js";import{U as me}from"./user-plus-Bom0zm7q.js";import{c as ce}from"./createLucideIcon-D3SAcWI1.js";import{U}from"./user-x-RJ6Px6xt.js";import{P as he}from"./phone-hJriLzf_.js";import{B as xe}from"./briefcase-Cz250yi8.js";/* empty css            */import"./x-D44ey90G.js";import"./overlayservice.esm-D-xaBf3o.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],K=ce("arrow-right-left",ue),P={id:1,name:"Gedung Aswad"},pe=[{id:2,building_id:1,name:"Kamar 2",building:P},{id:3,building_id:1,name:"Kamar 3",building:P},{id:4,building_id:2,name:"Kamar 1",building:{id:2,name:"Gedung Biru"}},{id:5,building_id:2,name:"Kamar 2",building:{id:2,name:"Gedung Biru"}}],_e=({room:s,unassignedUsers:c})=>{const i=s.users,[S,ge]=m.useState(pe),[$,p]=m.useState(!1),[A,g]=m.useState(!1),[B,h]=m.useState(!1),[b,y]=m.useState(s.name),{delete:T}=Y(null),[be,fe]=m.useState([]),[l,f]=m.useState([]),[x,C]=m.useState(null),[r,j]=m.useState(null),[d,N]=m.useState([]),R=()=>{y(s.name),p(!0)},z=()=>{setRoom({...s,name:b}),p(!1)},D=()=>{if(i.length>0){alert("Tidak bisa menghapus kamar yang masih berpenghuni!");return}k({message:`Apakah Anda yakin ingin menghapus ${s.name}?`,header:"Konfirmasi Hapus",icon:"pi pi-exclamation-triangle",acceptLabel:"Hapus",rejectLabel:"Batal",acceptClassName:"p-button-danger",accept:()=>{T("/admin/penginapan/gedung/"+s.building.name+"/kamar/"+s.id,{onError:a=>{console.log("Validation Errors:",a)},onSuccess:()=>console.log("SUCCESS")})}})},E=()=>{N([]),g(!0)},L=()=>{const t=c.filter(o=>d.includes(o.id)).map(o=>({...o,room_id:s.id}));setUsers([...i,...t]),setUnassignedUsers(c.filter(o=>!d.includes(o.id))),g(!1),alert(`Berhasil menambahkan ${d.length} peserta ke ${s.name}`)},M=a=>{C(a),j(null),h(!0)},_=()=>{r&&(setUsers(i.filter(a=>a.id!==x.id)),h(!1),alert(`${x.name} berhasil dipindah ke ${r.name} - ${r.building.name}`))},H=a=>{k({message:`Keluarkan ${a.name} dari ${s.name}?`,header:"Konfirmasi Keluarkan",icon:"pi pi-exclamation-triangle",acceptLabel:"Keluarkan",rejectLabel:"Batal",acceptClassName:"p-button-danger",accept:()=>{setUsers(i.filter(o=>o.id!==a.id));const t={...a,room_id:null};setUnassignedUsers([...c,t]),alert(`${a.name} berhasil dikeluarkan dari kamar`)}})},O=()=>{l.length!==0&&(C(null),j(null),h(!0))},F=()=>{l.length!==0&&k({message:`Keluarkan ${l.length} peserta dari ${s.name}?`,header:"Konfirmasi Keluarkan",icon:"pi pi-exclamation-triangle",acceptLabel:"Keluarkan",rejectLabel:"Batal",acceptClassName:"p-button-danger",accept:()=>{const a=i.filter(t=>l.includes(t.id));setUsers(i.filter(t=>!l.includes(t.id))),setUnassignedUsers([...c,...a.map(t=>({...t,room_id:null}))]),f([]),alert(`${a.length} peserta berhasil dikeluarkan dari kamar`)}})},G=()=>{!r||l.length===0||(setUsers(i.filter(a=>!l.includes(a.id))),f([]),h(!1),alert(`${l.length} peserta berhasil dipindah ke ${r.name} - ${r.building.name}`))},I=()=>{Z.get("/admin/penginapan/gedung/"+s.building.name)},J=a=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{label:a.name.charAt(0),size:"large",shape:"circle",className:"bg-emerald-600 text-white"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800",children:a.name}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[e.jsx(he,{size:12}),a.phone]})]})]}),V=a=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{size:14,className:"text-gray-500"}),e.jsxs("span",{className:"text-sm",children:[a.office.type," ",a.office.name]})]}),X=a=>{const t={Pembina:"info",Pengurus:"success",Pengawas:"warning",Anggota:"secondary"};return e.jsx(ne,{value:a.employment.name,severity:t[a.employment.name]||"secondary"})},q=a=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{icon:e.jsx(K,{size:16}),className:"p-button-rounded p-button-text p-button-info p-button-sm",onClick:()=>M(a),tooltip:"Pindah Kamar"}),e.jsx(n,{icon:e.jsx(U,{size:16}),className:"p-button-rounded p-button-text p-button-danger p-button-sm",onClick:()=>H(a),tooltip:"Keluarkan"})]}),Q=[...i].sort((a,t)=>{const o=a.name.localeCompare(t.name);return o!==0?o:a.office.name.localeCompare(t.office.name)}),W=S.map(a=>({label:`${a.building.name} - ${a.name}`,value:a}));return e.jsxs(ee,{children:[e.jsx(se,{}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:I,className:"mb-4 flex items-center gap-2 text-emerald-600 hover:text-emerald-700",children:[e.jsx(ie,{size:20}),e.jsxs("span",{className:"font-medium",children:["Kembali ke ",s.building.name]})]}),e.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{children:"Dashboard"}),e.jsx("span",{children:"›"}),e.jsx("span",{children:s.building.name}),e.jsx("span",{children:"›"}),e.jsx("span",{className:"font-medium text-gray-800",children:s.name})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:[s.building.name," - ",s.name]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{icon:e.jsx(re,{size:16}),label:"Edit Nama",className:"p-button-outlined p-button-sm",onClick:R}),e.jsx(n,{icon:e.jsx(de,{size:16}),label:"Hapus Kamar",className:"p-button-outlined p-button-danger p-button-sm",onClick:D,disabled:i.length>0})]})]})]}),e.jsx("div",{className:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-1",children:e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 text-sm text-gray-600",children:"Jumlah Penghuni"}),e.jsxs("p",{className:"text-3xl font-bold text-emerald-600",children:[i.length," Orang"]})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-emerald-100",children:e.jsx(oe,{className:"text-emerald-600",size:24})})]})})}),e.jsx("div",{className:"mb-6 rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(n,{label:"Tambah Peserta ke Kamar",icon:e.jsx(me,{size:16}),className:"p-button-success",onClick:E}),l.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(n,{label:`Pindahkan ${l.length} Peserta`,icon:e.jsx(K,{size:16}),className:"p-button-info",onClick:O}),e.jsx(n,{label:`Keluarkan ${l.length} Peserta`,icon:e.jsx(U,{size:16}),className:"p-button-danger",onClick:F})]})]})}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 p-4",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Daftar Penghuni"})}),e.jsxs(ae,{value:Q,selection:l,onSelectionChange:a=>f(a.value.map(t=>t.id)),dataKey:"id",emptyMessage:"Kamar ini masih kosong. Tambahkan peserta!",className:"text-sm",children:[e.jsx(u,{selectionMode:"multiple",headerStyle:{width:"3rem"}}),e.jsx(u,{field:"name",header:"Nama Peserta",body:J}),e.jsx(u,{field:"office.name",header:"Utusan",body:V}),e.jsx(u,{field:"employment.name",header:"Jabatan",body:X,style:{width:"150px"}}),e.jsx(u,{header:"Aksi",body:q,style:{width:"120px"}})]})]}),e.jsx(v,{header:"Edit Nama Kamar",visible:$,style:{width:"450px"},onHide:()=>p(!1),footer:e.jsxs("div",{children:[e.jsx(n,{label:"Batal",className:"p-button-text",onClick:()=>p(!1)}),e.jsx(n,{label:"Simpan",className:"p-button-success",onClick:z,disabled:!b.trim()})]}),children:e.jsx("div",{className:"flex flex-col gap-4 pt-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Nama Kamar ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(le,{value:b,onChange:a=>y(a.target.value),placeholder:"Contoh: Kamar 1",className:"w-full",autoFocus:!0})]})})}),e.jsx(v,{header:`Tambah Peserta ke ${s.name}`,visible:A,style:{width:"600px",maxHeight:"80vh"},onHide:()=>g(!1),footer:e.jsxs("div",{children:[e.jsx(n,{label:"Batal",className:"p-button-text",onClick:()=>g(!1)}),e.jsx(n,{label:`Tambahkan ${d.length} Peserta`,className:"p-button-success",onClick:L,disabled:d.length===0})]}),children:e.jsxs("div",{className:"flex flex-col gap-4 pt-4",children:[e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsxs("strong",{children:[i.length," orang"]})," sudah berada di kamar ini"]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto rounded-lg border border-gray-200",children:c.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Tidak ada peserta yang belum terplotting"}):c.map(a=>e.jsxs("div",{className:`flex cursor-pointer items-center gap-3 border-b border-gray-100 p-3 hover:bg-gray-50 ${d.includes(a.id)?"bg-emerald-50":""}`,onClick:()=>{d.includes(a.id)?N(d.filter(t=>t!==a.id)):N([...d,a.id])},children:[e.jsx("input",{type:"checkbox",checked:d.includes(a.id),onChange:()=>{},className:"h-4 w-4"}),e.jsx(w,{label:a.name.charAt(0),size:"normal",shape:"circle",className:"bg-emerald-600 text-white"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-800",children:a.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a.office.name," • ",a.employment.name]})]})]},a.id))})]})}),e.jsx(v,{header:x?`Pindahkan ${x.name}`:`Pindahkan ${l.length} Peserta`,visible:B,style:{width:"500px"},onHide:()=>h(!1),footer:e.jsxs("div",{children:[e.jsx(n,{label:"Batal",className:"p-button-text",onClick:()=>h(!1)}),e.jsx(n,{label:"Pindahkan",className:"p-button-info",onClick:x?_:G,disabled:!r})]}),children:e.jsxs("div",{className:"flex flex-col gap-4 pt-4",children:[e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-3",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Dari:"})," ",s.building.name," - ",s.name]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Pindah ke Kamar ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(te,{value:r,options:W,onChange:a=>j(a.value),placeholder:"Pilih kamar tujuan",className:"w-full",filter:!0})]}),r&&e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["Kamar tujuan dipilih:"," ",e.jsxs("strong",{children:[r.building.name," - ",r.name]})]})})]})})]})};export{_e as default};
