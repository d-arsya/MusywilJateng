import{r as c,h as G,j as e,a as O}from"./app-DMqxqPJM.js";import{A as U}from"./admin-BjmkL1yy.js";import{A as z}from"./avatar.esm-77dLfQQ7.js";import{B as o}from"./badge.esm-DqLfXqIq.js";import{D as V,C as i}from"./datatable.esm-DpbtT2Zb.js";import{C as I,c as b}from"./confirmdialog.esm-Dzs_Yrkq.js";import{D as Y}from"./dropdown.esm-CQUAa7zv.js";import{I as W}from"./inputtext.esm-CqZLBaoz.js";import{T as n}from"./tag.esm-Df4OKypR.js";import{C as X}from"./credit-card-DdNdcpaP.js";import{F as q}from"./file-text-BXM9SCy9.js";import{U as J}from"./users-BhxOVoR-.js";import{C as p}from"./circle-check-BF0GepOt.js";import{C as j}from"./clock-BzdlqY_5.js";import{C as y}from"./circle-x-B_xe_R-K.js";import{S as H}from"./search-B4a9hfZ3.js";import{C as v}from"./circle-alert-BgqqheGL.js";import{c as w}from"./createLucideIcon-DqFWOxZ4.js";/* empty css            */import"./x-DJIJzLN8.js";import"./button.esm-C0xj6u3o.js";import"./overlayservice.esm-u3reRXgZ.js";import"./dialog.esm-BDgGQl6K.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],Z=w("banknote",Q);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],N=w("eye",ee);function ke({payments:t}){const[k,u]=c.useState(null),[h,C]=c.useState(""),[m,P]=c.useState(null),{showToast:d}=G();c.useEffect(()=>{const a=t.filter(s=>s.paid);u(a)},[t]);const r={verified:t.filter(a=>a.paid).length,pending:t.filter(a=>a.invoice&&!a.paid).length,unpaid:t.filter(a=>!a.invoice&&!a.paid).length,totalAmount:t.filter(a=>a.paid).length*5e5},T=1800,f=async(a,s,l)=>{const _=document.querySelector('meta[name="csrf-token"]')?.content,E=`/pembayaran/${s}/${a}`;try{const g=await fetch(E,{method:"POST",headers:{"X-CSRF-TOKEN":_,"Content-Type":"application/json"}}),x=s==="check"?"mengonfirmasi":"membatalkan";return g.ok?(d(s==="check"?"success":"warn","Berhasil!",`Berhasil ${x} pembayaran ${l}`),!0):(d("error","Gagal!",`Gagal ${x} pembayaran ${l}`),!1)}catch{return d("error","Gagal!",`Gagal ${s==="check"?"mengonfirmasi":"membatalkan"} pembayaran ${l}`),!1}finally{setTimeout(()=>{O.reload({only:["payments"],preserveScroll:!0})},T)}},S=a=>{b({message:`Konfirmasi pembayaran dari ${a.data.name}?`,header:"Konfirmasi Verifikasi",icon:e.jsx(p,{className:"h-6 w-6 text-emerald-600"}),acceptClassName:"p-button-success",acceptLabel:"Ya, Verifikasi",rejectLabel:"Batal",accept:()=>f(a.data.code,"check",a.data.name)})},B=a=>{b({message:`Batalkan verifikasi pembayaran ${a.data.name}?`,header:"Konfirmasi Pembatalan",icon:e.jsx(v,{className:"h-6 w-6 text-amber-600"}),acceptClassName:"p-button-warning",acceptLabel:"Ya, Batalkan",rejectLabel:"Tidak",accept:()=>f(a.data.code,"uncheck",a.data.name)})},L=[{label:"Semua Status",value:null},{label:"Terverifikasi",value:"verified"},{label:"Menunggu",value:"pending"},{label:"Belum Bayar",value:"unpaid"}],A=()=>{if(!m)return t;switch(m){case"verified":return t.filter(a=>a.paid);case"pending":return t.filter(a=>a.invoice&&!a.paid);case"unpaid":return t.filter(a=>!a.invoice&&!a.paid);default:return t}},R=e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-4",children:[e.jsxs("div",{className:"rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 p-4 text-white shadow-lg",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx(J,{className:"h-8 w-8 opacity-80"}),e.jsx(o,{value:r.total,className:"bg-white/20"})]}),e.jsx("p",{className:"text-sm opacity-90",children:"Total Peserta"}),e.jsx("p",{className:"text-2xl font-bold",children:r.total})]}),e.jsxs("div",{className:"rounded-xl bg-gradient-to-br from-emerald-500 to-emerald-600 p-4 text-white shadow-lg",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx(p,{className:"h-8 w-8 opacity-80"}),e.jsx(o,{value:r.verified,severity:"success",className:"bg-white/20"})]}),e.jsx("p",{className:"text-sm opacity-90",children:"Terverifikasi"}),e.jsx("p",{className:"text-2xl font-bold",children:r.verified})]}),e.jsxs("div",{className:"rounded-xl bg-gradient-to-br from-amber-500 to-orange-600 p-4 text-white shadow-lg",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx(j,{className:"h-8 w-8 opacity-80"}),e.jsx(o,{value:r.pending,severity:"warning",className:"bg-white/20"})]}),e.jsx("p",{className:"text-sm opacity-90",children:"Menunggu"}),e.jsx("p",{className:"text-2xl font-bold",children:r.pending})]}),e.jsxs("div",{className:"rounded-xl bg-gradient-to-br from-red-500 to-rose-600 p-4 text-white shadow-lg",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx(y,{className:"h-8 w-8 opacity-80"}),e.jsx(o,{value:r.unpaid,severity:"danger",className:"bg-white/20"})]}),e.jsx("p",{className:"text-sm opacity-90",children:"Belum Bayar"}),e.jsx("p",{className:"text-2xl font-bold",children:r.unpaid})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 rounded-xl bg-white p-4 shadow-md lg:flex-row",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(H,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx(W,{value:h,onChange:a=>C(a.target.value),placeholder:"Cari nama atau kode peserta...",className:"w-full pl-10"})]}),e.jsx(Y,{value:m,onChange:a=>P(a.value),options:L,placeholder:"Filter Status",className:"w-full lg:w-48"})]}),e.jsx("div",{className:"rounded-lg border-l-4 border-blue-500 bg-blue-50 p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(v,{className:"mt-0.5 mr-3 h-5 w-5 text-blue-600"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"mb-1 font-semibold",children:"Panduan Verifikasi Pembayaran"}),e.jsxs("p",{children:["• Centang checkbox untuk ",e.jsx("strong",{children:"memverifikasi"})," pembayaran yang sudah valid"]}),e.jsxs("p",{children:["• Uncheck untuk ",e.jsx("strong",{children:"membatalkan"})," verifikasi yang salah"]}),e.jsx("p",{children:'• Klik "Bukti" untuk melihat bukti transfer peserta'})]})]})})]}),$=a=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z,{image:a.avatar||`https://ui-avatars.com/api/?name=${a.name}&background=10b981&color=fff`,shape:"circle",size:"large",className:"border-2 border-emerald-100"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:a.name}),e.jsx("p",{className:"font-mono text-xs text-gray-500",children:a.code})]})]}),F=a=>{const s={DPW:"info",DPD:"success",DMW:"warning",Kampus:"help",Orpen:"danger"};return e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{value:a.office.type,severity:s[a.office.type]||"info",className:"text-xs font-semibold"}),e.jsx("p",{className:"text-sm text-gray-700",children:a.office.name})]})},M=a=>{const s={Pembina:"bg-purple-100 text-purple-700",Pengurus:"bg-blue-100 text-blue-700",Pengawas:"bg-amber-100 text-amber-700",Anggota:"bg-gray-100 text-gray-700"};return e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold ${s[a.employment.name]||s.Anggota}`,children:a.employment.name})},D=a=>{const{paid:s,invoice:l}=a;return s?e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx(n,{value:"Terverifikasi",severity:"success",icon:e.jsx(p,{className:"mr-1 h-3 w-3"}),className:"font-semibold"}),l?e.jsxs("a",{href:l,target:"_blank",className:"inline-flex items-center gap-1 rounded-lg bg-emerald-500 px-3 py-1 text-xs font-semibold text-white transition hover:bg-emerald-600",children:[e.jsx(N,{className:"h-3 w-3"}),"Bukti"]}):e.jsx(n,{value:"Cash",icon:e.jsx(Z,{className:"mr-1 h-3 w-3"}),className:"bg-blue-500 font-semibold text-white"})]}):l?e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx(n,{value:"Menunggu",severity:"warning",icon:e.jsx(j,{className:"mr-1 h-3 w-3"}),className:"font-semibold"}),e.jsxs("a",{href:l,target:"_blank",className:"inline-flex items-center gap-1 rounded-lg bg-amber-500 px-3 py-1 text-xs font-semibold text-white transition hover:bg-amber-600",children:[e.jsx(N,{className:"h-3 w-3"}),"Cek"]})]}):e.jsx(n,{value:"Belum Bayar",severity:"danger",icon:e.jsx(y,{className:"mr-1 h-3 w-3"}),className:"font-semibold"})},K=A();return e.jsxs(U,{children:[e.jsx(I,{}),e.jsxs("div",{className:"space-y-6 p-2 md:p-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"flex items-center text-3xl font-bold text-gray-800",children:[e.jsx(X,{className:"mr-3 h-8 w-8 text-emerald-600"}),"Verifikasi Pembayaran"]}),e.jsx("p",{className:"mt-1 text-gray-600",children:"Kelola dan verifikasi kontribusi peserta"})]})}),e.jsx("div",{className:"overflow-hidden rounded-2xl bg-white shadow-lg",children:e.jsxs(V,{value:K,selection:k,onSelectionChange:a=>u(a.value),onRowSelect:S,onRowUnselect:B,dataKey:"id",paginator:!0,rows:15,rowsPerPageOptions:[15,25,50,100],globalFilter:h,header:R,emptyMessage:e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(q,{className:"mx-auto mb-4 h-16 w-16 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-500",children:"Tidak ada data pembayaran"})]}),stripedRows:!0,showGridlines:!0,responsiveLayout:"scroll",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Menampilkan {first} - {last} dari {totalRecords} peserta",children:[e.jsx(i,{selectionMode:"multiple",frozen:!0}),e.jsx(i,{body:$,header:"Peserta",sortable:!0,field:"name"}),e.jsx(i,{body:F,header:"Utusan",sortable:!0,sortField:"office.name",headerClassName:"hidden lg:table-cell",bodyClassName:"hidden lg:table-cell"}),e.jsx(i,{body:M,header:"Jabatan",field:"employment.name",headerClassName:"hidden md:table-cell",bodyClassName:"hidden md:table-cell"}),e.jsx(i,{body:D,header:"Status",sortable:!0,sortField:"paid"})]})})]})]})}export{ke as default};
