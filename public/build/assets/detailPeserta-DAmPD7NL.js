import{u as D,r as n,j as e}from"./app-CAlMH3Bd.js";import{A as I}from"./admin-CvKnKrZz.js";import{C as $,g as E}from"./index.module-D2rnWUon.js";import{U as u}from"./user-S5u-UUhQ.js";import{U as M}from"./upload-D1XdFE-8.js";import{C as J}from"./circle-alert-Dtjx0vyg.js";import{P as G}from"./phone-BJwVws0G.js";import{B as K}from"./briefcase-DolPki9p.js";import{C as L}from"./calendar-DE2i51vU.js";import{S as R}from"./save-Cbyg_2rd.js";import{X as T}from"./x-18ieLOZ0.js";/* empty css            */import"./createLucideIcon-DfM1_4bx.js";function le({employments:g,user:b,offices:f}){const c=b,{data:l,setData:x,post:j}=D(c),[N,v]=n.useState(c.avatar),[p,O]=n.useState(!1),[a,d]=n.useState({}),i=s=>{const{name:r,value:t}=s.target;x(r,t)},[h,y]=n.useState(null),[w,m]=n.useState(!1),[C,P]=n.useState({x:0,y:0}),[k,S]=n.useState(1),[U,_]=n.useState(null),A=(s,r)=>_(r),F=s=>{const r=s.target.files?.[0];if(!r)return;if(r.size>2048*1024){d(o=>({...o,avatar:"Ukuran file maksimal 2MB"}));return}if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(r.type)){d(o=>({...o,avatar:"Format file harus JPG, PNG, atau WebP"}));return}const t=new FileReader;t.onload=()=>{y(t.result),m(!0)},t.readAsDataURL(r),d(o=>({...o,avatar:null}))},z=async s=>{console.log(l),s.preventDefault(),j("/admin/peserta/"+l.code,{onError:r=>console.log(r)})},B=()=>{confirm("Batalkan perubahan? Data yang belum disimpan akan hilang.")&&window.history.back()};return e.jsx(I,{children:e.jsx("div",{className:"min-h-screen p-4 md:p-8",children:e.jsxs("div",{className:"mx-auto max-w-4xl",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Edit Data Peserta"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Perbarui informasi peserta Muswil VI Hidayatullah"})]}),e.jsx("div",{className:"rounded-lg bg-emerald-100 px-4 py-2",children:e.jsxs("span",{className:"text-sm font-semibold text-emerald-700",children:["Kode: ",l.code]})})]}),e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-lg",children:[e.jsxs("h2",{className:"mb-4 flex items-center text-lg font-semibold text-gray-800",children:[e.jsx(u,{className:"mr-2 h-5 w-5 text-emerald-600"}),"Foto Profil"]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-32 w-32 overflow-hidden rounded-2xl border-4 border-gray-100 shadow-md",children:e.jsx("img",{src:N||"/assets/img/placeholder.webp",alt:"Avatar",className:"h-full w-full object-cover"})}),e.jsx("label",{htmlFor:"avatar-upload",className:"absolute -right-2 -bottom-2 flex h-10 w-10 cursor-pointer items-center justify-center rounded-full bg-emerald-600 text-white shadow-lg transition hover:bg-emerald-700",children:e.jsx(M,{className:"h-5 w-5"})}),e.jsx("input",{id:"avatar-upload",type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:F,className:"hidden"})]}),w&&e.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-black/60",children:[e.jsx("div",{className:"relative h-80 w-80 bg-black",children:e.jsx($,{image:h,crop:C,zoom:k,aspect:1,onCropChange:P,onZoomChange:S,onCropComplete:A})}),e.jsxs("div",{className:"mt-4 flex gap-4",children:[e.jsx("button",{onClick:()=>m(!1),className:"rounded bg-gray-300 px-4 py-2",children:"Batal"}),e.jsx("button",{onClick:async()=>{const s=await E(h,U);v(s);const t=await(await fetch(s)).blob();x("avatar",t),m(!1)},className:"rounded bg-emerald-600 px-4 py-2 text-white hover:bg-emerald-700",children:"Pilih"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"mb-1 font-medium text-gray-700",children:"Upload foto peserta"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Format: JPG, PNG, WebP (Max 2MB)"}),a.avatar&&e.jsxs("p",{className:"mt-2 flex items-center text-sm text-red-600",children:[e.jsx(J,{className:"mr-1 h-4 w-4"}),a.avatar]})]})]})]}),e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-lg",children:[e.jsxs("h2",{className:"mb-4 flex items-center text-lg font-semibold text-gray-800",children:[e.jsx(u,{className:"mr-2 h-5 w-5 text-emerald-600"}),"Informasi Pribadi"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Nama Lengkap *"}),e.jsx("input",{type:"text",name:"name",value:l.name,onChange:i,className:`w-full rounded-lg border-2 ${a.name?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`,placeholder:"Masukkan nama lengkap"}),a.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 flex items-center text-sm font-medium text-gray-700",children:[e.jsx(G,{className:"mr-1 h-4 w-4"}),"Nomor Telepon *"]}),e.jsx("input",{type:"tel",name:"phone",value:l.phone,onChange:i,className:`w-full rounded-lg border-2 ${a.phone?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`,placeholder:"08xxxxxxxxxx"}),a.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Ukuran Peci *"}),e.jsx("input",{type:"number",name:"capsize",value:l.capsize,onChange:i,className:`w-full rounded-lg border-2 ${a.capsize?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`}),a.capsize&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.capsize})]})]})]}),e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-lg",children:[e.jsxs("h2",{className:"mb-4 flex items-center text-lg font-semibold text-gray-800",children:[e.jsx(K,{className:"mr-2 h-5 w-5 text-emerald-600"}),"Informasi Organisasi"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Utusan *"}),e.jsxs("select",{name:"office_id",value:l.office_id,onChange:i,className:`w-full rounded-lg border-2 ${a.office_id?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`,children:[e.jsx("option",{value:"",children:"Pilih Utusan"}),Object.entries(f).map(([s,r])=>e.jsx("optgroup",{label:s,children:r.map(t=>e.jsxs("option",{value:t.id,children:[t.type," ",t.name]},t.id))},s))]}),a.office_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.office_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Jabatan *"}),e.jsxs("select",{name:"employment_id",value:l.employment_id,onChange:i,className:`w-full rounded-lg border-2 ${a.employment_id?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`,children:[e.jsx("option",{value:"",children:"Pilih Jabatan"}),g.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),a.employment_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.employment_id})]})]})]}),e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-lg",children:[e.jsxs("h2",{className:"mb-4 flex items-center text-lg font-semibold text-gray-800",children:[e.jsx(L,{className:"mr-2 h-5 w-5 text-emerald-600"}),"Jadwal Kehadiran"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Tanggal Kedatangan *"}),e.jsx("input",{type:"date",name:"arrive",value:l.arrive,onChange:i,className:`w-full rounded-lg border-2 ${a.arrive?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`}),a.arrive&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.arrive})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Tanggal Kepulangan *"}),e.jsx("input",{type:"date",name:"depart",value:l.depart,onChange:i,className:`w-full rounded-lg border-2 ${a.depart?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`}),a.depart&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.depart})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"submit",disabled:p,className:"flex flex-1 items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-emerald-600 to-teal-600 px-6 py-4 font-semibold text-white shadow-lg transition hover:shadow-xl disabled:cursor-not-allowed disabled:opacity-50",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-5 w-5"}),"Simpan Perubahan"]})}),e.jsxs("button",{type:"button",onClick:B,className:"flex items-center justify-center gap-2 rounded-xl border-2 border-gray-300 bg-white px-6 py-4 font-semibold text-gray-700 transition hover:bg-gray-50",children:[e.jsx(T,{className:"h-5 w-5"}),"Batal"]})]})]})]})})})}export{le as default};
