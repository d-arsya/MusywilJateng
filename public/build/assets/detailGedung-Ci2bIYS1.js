import{r as t,u as k,j as e,a as S}from"./app-cVYzcNFA.js";import{A as se}from"./admin-pmxFi997.js";import{A as ae}from"./avatar.esm-CvrRZvyG.js";import{B as r}from"./button.esm-BHkMMVY3.js";import{D as te,C as d}from"./datatable.esm-AgVpFHuh.js";import{C as re,c as le}from"./confirmdialog.esm-CWM58JPl.js";import{D as T}from"./dialog.esm-DOPU4wUs.js";import{I as g}from"./inputtext.esm-BVc8urw_.js";import{T as m}from"./tag.esm-BMSm3P67.js";import{A as ne}from"./arrow-left-DiGi6LKt.js";import{D}from"./door-open-hMs0xu72.js";import{U as R}from"./users-Cp4izl_k.js";import{P as oe}from"./plus-icgw40Ud.js";import{U as ie}from"./user-plus-B-0oOS4S.js";import{P as de,T as ce}from"./trash-2-CN7F8dal.js";/* empty css            */import"./x-azWwepW9.js";import"./createLucideIcon-YI8goVHh.js";import"./dropdown.esm-Cye0p_7v.js";import"./overlayservice.esm-DKYFKBpm.js";const Be=({building:n,rooms:u,unassignedUsers:A})=>{const[E,o]=t.useState(!1),[P,i]=t.useState(!1),[x,b]=t.useState(!1),[U,p]=t.useState(null),[me,B]=t.useState(""),[j,K]=t.useState(""),[f,L]=t.useState(null),[ue,xe]=t.useState([]),[h,N]=t.useState(""),{data:v,setData:y,post:_,put:z,delete:H}=k({name:""}),{data:a,setData:c,put:Q}=k({room:null,users:[]}),V=()=>{b(!1),p(null),B(""),o(!0)},$=s=>{b(!0),p(s),y("name",s.name),o(!0)},M=()=>{x?z("/admin/penginapan/gedung/"+n.name+"/kamar/"+U.id,{onError:s=>{console.log("Validation Errors:",s)},onSuccess:()=>console.log("SUCCESS")}):_("/admin/penginapan/gedung/"+n.name+"/kamar",{onError:s=>{console.log("Validation Errors:",s)},onSuccess:()=>console.log("SUCCESS")}),o(!1)},O=s=>{if(s.users_count>0){alert("Tidak bisa menghapus kamar yang masih berpenghuni!");return}le({message:`Apakah Anda yakin ingin menghapus ${s.name}?`,header:"Konfirmasi Hapus",icon:"pi pi-exclamation-triangle",acceptLabel:"Hapus",rejectLabel:"Batal",acceptClassName:"p-button-danger",accept:()=>{H("/admin/penginapan/gedung/"+n.name+"/kamar/"+s.id,{onError:l=>{console.log("Validation Errors:",l)},onSuccess:()=>console.log("SUCCESS")})}})},F=s=>{S.get("/admin/penginapan/gedung/"+n.name+"/kamar/"+s.name)},I=s=>{p(s),L(s),c("room",s.id),c("users",[]),N(""),i(!0)},G=()=>{Q("/admin/penginapan/assign",{onSuccess:()=>i(!1),onError:()=>i(!1)})},J=()=>{S.get("/admin/penginapan")},q=s=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-purple-100",children:e.jsx(D,{className:"text-purple-600",size:20})}),e.jsx("div",{children:e.jsx("div",{className:"font-semibold text-gray-800",children:s.name})})]}),W=s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{size:16,className:"text-gray-500"}),e.jsxs("span",{className:"font-medium",children:[s.users_count," Orang"]})]}),X=s=>s.users_count===0?e.jsx(m,{value:"Kosong",severity:"secondary"}):s.users_count<5?e.jsx(m,{value:"Tersedia",severity:"success"}):s.users_count<8?e.jsx(m,{value:"Sedang",severity:"warning"}):e.jsx(m,{value:"Ramai",severity:"info"}),Y=s=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{icon:e.jsx(ie,{size:16}),className:"p-button-rounded p-button-text p-button-success p-button-sm",onClick:()=>I(s),tooltip:"Tambah Peserta"}),e.jsx(r,{icon:e.jsx(de,{size:16}),className:"p-button-rounded p-button-text p-button-sm",onClick:()=>$(s),tooltip:"Edit"}),e.jsx(r,{icon:e.jsx(ce,{size:16}),className:"p-button-rounded p-button-text p-button-danger p-button-sm",onClick:()=>O(s),tooltip:"Hapus",disabled:s.users_count>0})]}),Z=s=>e.jsx(r,{label:"Lihat Detail",className:"p-button-sm p-button-outlined",onClick:()=>F(s)}),ee=u.filter(s=>s.name.toLowerCase().includes(j.toLowerCase())).sort((s,l)=>{const w=s.name.localeCompare(l.name);return w!==0?w:l.users_count-s.users_count}),C=A.filter(s=>s.name.toLowerCase().includes(h.toLowerCase())||s.office.name.toLowerCase().includes(h.toLowerCase()));return e.jsxs(se,{children:[e.jsx(re,{}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:J,className:"mb-4 flex items-center gap-2 text-emerald-600 hover:text-emerald-700",children:[e.jsx(ne,{size:20}),e.jsx("span",{className:"font-medium",children:"Kembali ke Dashboard"})]}),e.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{children:"Dashboard"}),e.jsx("span",{children:"›"}),e.jsx("span",{className:"font-medium text-gray-800",children:n.name})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:n.name})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 text-sm text-gray-600",children:"Total Kamar"}),e.jsx("p",{className:"text-3xl font-bold text-gray-800",children:u.length})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-purple-100",children:e.jsx(D,{className:"text-purple-600",size:24})})]})}),e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 text-sm text-gray-600",children:"Total Penghuni"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-600",children:u.reduce((s,l)=>s+l.users_count,0)})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-emerald-100",children:e.jsx(R,{className:"text-emerald-600",size:24})})]})})]}),e.jsx("div",{className:"mb-6 rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:e.jsx("div",{className:"flex flex-wrap gap-3",children:e.jsx(r,{label:"Tambah Kamar Baru",icon:e.jsx(oe,{size:16}),className:"p-button-success",onClick:V})})}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Daftar Kamar"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"p-input-icon-left",children:e.jsx(g,{placeholder:"Cari kamar...",value:j,onChange:s=>K(s.target.value),className:"p-inputtext-sm"})})})]})}),e.jsxs(te,{value:ee,emptyMessage:"Belum ada kamar. Tambahkan kamar pertama!",className:"text-sm",children:[e.jsx(d,{field:"name",header:"Nama Kamar",body:q}),e.jsx(d,{field:"users_count",header:"Jumlah Penghuni",body:W}),e.jsx(d,{header:"Status",body:X,style:{width:"120px"}}),e.jsx(d,{header:"Detail",body:Z,style:{width:"150px"}}),e.jsx(d,{header:"Aksi",body:Y,style:{width:"150px"}})]})]}),e.jsx(T,{header:x?"Edit Kamar":"Tambah Kamar Baru",visible:E,style:{width:"450px"},onHide:()=>o(!1),footer:e.jsxs("div",{children:[e.jsx(r,{label:"Batal",className:"p-button-text",onClick:()=>o(!1)}),e.jsx(r,{label:x?"Simpan":"Tambah",className:"p-button-success",onClick:M,disabled:!v.name.trim()})]}),children:e.jsx("div",{className:"flex flex-col gap-4 pt-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Nama Kamar ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(g,{value:v.name,onChange:s=>y("name",s.target.value),placeholder:"Contoh: Kamar 1",className:"w-full",autoFocus:!0})]})})}),e.jsx(T,{header:`Tambah Peserta ke ${f?.name}`,visible:P,style:{width:"600px",maxHeight:"80vh"},onHide:()=>i(!1),footer:e.jsxs("div",{children:[e.jsx(r,{label:"Batal",className:"p-button-text",onClick:()=>i(!1)}),e.jsx(r,{label:`Assign ${a.users.length} Peserta`,className:"p-button-success",onClick:G,disabled:a.users.length===0})]}),children:e.jsxs("div",{className:"flex flex-col gap-4 pt-4",children:[e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsxs("strong",{children:[f?.users_count||0," orang"]})," sudah berada di kamar ini"]})}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Pilih Peserta Belum Terplotting"}),e.jsx("span",{className:"p-input-icon-left w-full",children:e.jsx(g,{placeholder:"Cari nama atau utusan...",value:h,onChange:s=>N(s.target.value),className:"w-full"})})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto rounded-lg border border-gray-200",children:C.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Tidak ada peserta yang belum terplotting"}):C.map(s=>e.jsxs("div",{className:`flex cursor-pointer items-center gap-3 border-b border-gray-100 p-3 hover:bg-gray-50 ${a.users.includes(s.id)?"bg-emerald-50":""}`,onClick:()=>{a.users.includes(s.id)?c("users",a.users.filter(l=>l!==s.id)):c("users",[...a.users,s.id])},children:[e.jsx("input",{type:"checkbox",checked:a.users.includes(s.id),onChange:()=>{},className:"h-4 w-4"}),e.jsx(ae,{label:s.name.charAt(0),size:"normal",shape:"circle",className:"bg-emerald-600 text-white"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-800",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:[s.office.name," • ",s.employment.name]})]})]},s.id))}),a.users.length>0&&e.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 p-3",children:e.jsxs("p",{className:"text-sm text-emerald-800",children:[e.jsxs("strong",{children:[a.users.length," peserta"]})," dipilih untuk di-assign"]})})]})})]})};export{Be as default};
