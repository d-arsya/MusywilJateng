import{r as d,u as k,j as e,a as ae}from"./app-DdHxj1G8.js";import{A as se}from"./admin-DcMQm5Jv.js";import{A as w}from"./avatar.esm-HpmVexva.js";import{B as l}from"./button.esm-PseBekpH.js";import{D as ne,C as p}from"./datatable.esm-9GPmnwoO.js";import{C as te,c as f}from"./confirmdialog.esm-4oxoEIeT.js";import{D as j}from"./dialog.esm-7qO4n0j8.js";import{D as le}from"./dropdown.esm-ZV8vDXtB.js";import{I as re}from"./inputtext.esm-C0DjQwZg.js";import{T as ie}from"./tag.esm-BN84JanJ.js";import{A as oe}from"./arrow-left-CZNAjlDt.js";import{P as de,T as ce}from"./trash-2-CGumau8D.js";import{U as me}from"./users-D7syYrLt.js";import{U as xe}from"./user-plus-BUOHKIWW.js";import{c as he}from"./createLucideIcon-BkR-pTnK.js";import{U as C}from"./user-x-eUkqXd1-.js";import{P as ue}from"./phone-CemSPpbJ.js";import{B as pe}from"./briefcase-DHoC4pMf.js";/* empty css            */import"./x-Ci_0765m.js";import"./overlayservice.esm-7nvQUjuj.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],be=he("arrow-right-left",ge),Me=({room:s,unassignedUsers:N,otherRooms:S})=>{const m=s.users,[D,x]=d.useState(!1),[P,r]=d.useState(!1),[K,h]=d.useState(!1),[U,A]=d.useState(s.name),{delete:E,data:B,setData:T,put:R}=k({name:s.name}),[o,v]=d.useState([]),[b,$]=d.useState(null),[c,y]=d.useState(null),{data:t,setData:i,put:u}=k({users:[],room:s.id}),z=()=>{A(s.name),x(!0)},L=()=>{R("/admin/penginapan/gedung/"+s.building.name+"/kamar/"+s.id,{onError:a=>{console.log("Validation Errors:",a),x(!1)},onSuccess:()=>x(!1)})},M=()=>{m.length>0||f({message:`Apakah Anda yakin ingin menghapus ${s.name}?`,header:"Konfirmasi Hapus",icon:"pi pi-exclamation-triangle",acceptLabel:"Hapus",rejectLabel:"Batal",acceptClassName:"p-button-danger",accept:()=>{E("/admin/penginapan/gedung/"+s.building.name+"/kamar/"+s.id,{onError:a=>{console.log("Validation Errors:",a)},onSuccess:()=>console.log("SUCCESS")})}})},H=()=>{i("users",[]),r(!0)},F=()=>{u("/admin/penginapan/assign",{onSuccess:()=>r(!1),onError:()=>r(!1)})},I=()=>{i("room",c.id),u("/admin/penginapan/assign",{onSuccess:()=>h(!1),onError:a=>console.log(a)})},O=a=>{f({message:`Keluarkan ${a.name} dari ${s.name}?`,header:"Konfirmasi Keluarkan",icon:"pi pi-exclamation-triangle",acceptLabel:"Keluarkan",rejectLabel:"Batal",acceptClassName:"p-button-danger",accept:()=>{v([]),u("/admin/penginapan/unassigned/"+a.code,{onSuccess:()=>{r(!1)},onError:n=>{r(!1)}})}})},J=()=>{o.length!==0&&($(null),y(null),h(!0))},V=()=>{o.length!==0&&f({message:`Keluarkan ${o.length} peserta dari ${s.name}?`,header:"Konfirmasi Keluarkan",icon:"pi pi-exclamation-triangle",acceptLabel:"Keluarkan",rejectLabel:"Batal",acceptClassName:"p-button-danger",accept:()=>{let a=o.map(n=>n.code);u("/admin/penginapan/unassigned/bulk?code="+a.join(","),{onSuccess:()=>r(!1),onError:n=>{console.log(n)}})}})},_=()=>{!c||t.length===0||(console.log(t),u("/admin/penginapan/assign",{onSuccess:()=>h(!1),onError:a=>console.log(a)}))},X=()=>{ae.get("/admin/penginapan/gedung/"+s.building.name)},q=a=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{label:a.name.charAt(0),size:"large",shape:"circle",className:"bg-emerald-600 text-white"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800",children:a.name}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[e.jsx(ue,{size:12}),a.phone]})]})]}),G=a=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{size:14,className:"text-gray-500"}),e.jsxs("span",{className:"text-sm",children:[a.office.type," ",a.office.name]})]}),Q=a=>{const n={Pembina:"info",Pengurus:"success",Pengawas:"warning",Anggota:"secondary"};return e.jsx(ie,{value:a.employment.name,severity:n[a.employment.name]||"secondary"})},W=a=>e.jsx("div",{className:"flex gap-2",children:e.jsx(l,{icon:e.jsx(C,{size:16}),className:"p-button-rounded p-button-text p-button-danger",onClick:()=>O(a),tooltip:"Keluarkan"})}),Y=[...m].sort((a,n)=>{const g=a.name.localeCompare(n.name);return g!==0?g:a.office.name.localeCompare(n.office.name)}),Z=S.map(a=>({label:`${a.building.name} - ${a.name}`,value:a}));return e.jsxs(se,{children:[e.jsx(te,{}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:X,className:"mb-4 flex items-center gap-2 text-emerald-600 hover:text-emerald-700",children:[e.jsx(oe,{size:20}),e.jsxs("span",{className:"font-medium",children:["Kembali ke ",s.building.name]})]}),e.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{children:"Dashboard"}),e.jsx("span",{children:"›"}),e.jsx("span",{children:s.building.name}),e.jsx("span",{children:"›"}),e.jsx("span",{className:"font-medium text-gray-800",children:s.name})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:[s.building.name," - ",s.name]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{icon:e.jsx(de,{size:16}),label:"Edit",className:"p-button-outlined p-button-sm",onClick:z}),e.jsx(l,{icon:e.jsx(ce,{size:16}),label:"Hapus",className:"p-button-outlined p-button-danger p-button-sm",onClick:M,disabled:m.length>0})]})]})]}),e.jsx("div",{className:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-1",children:e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 text-sm text-gray-600",children:"Jumlah Penghuni"}),e.jsxs("p",{className:"text-3xl font-bold text-emerald-600",children:[m.length," Orang"]})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-emerald-100",children:e.jsx(me,{className:"text-emerald-600",size:24})})]})})}),e.jsx("div",{className:"mb-6 rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(l,{label:"Tambah Peserta ke Kamar",icon:e.jsx(xe,{size:16}),className:"p-button-success",onClick:H}),o.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(l,{label:`Pindahkan ${t.users.length} Peserta`,icon:e.jsx(be,{size:16}),className:"p-button-info",onClick:J}),e.jsx(l,{label:`Keluarkan ${t.users.length} Peserta`,icon:e.jsx(C,{size:16}),className:"p-button-danger",onClick:V})]})]})}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 p-4",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Daftar Penghuni"})}),e.jsxs(ne,{value:Y,selection:o,onSelectionChange:a=>{const n=a.value,g=n.map(ee=>ee.id);v(n),i("users",g)},dataKey:"id",emptyMessage:"Kamar ini masih kosong. Tambahkan peserta!",className:"text-sm",children:[e.jsx(p,{selectionMode:"multiple",headerStyle:{width:"3rem"}}),e.jsx(p,{field:"name",header:"Nama Peserta",body:q}),e.jsx(p,{field:"office.name",header:"Utusan",body:G}),e.jsx(p,{field:"employment.name",header:"Jabatan",body:Q,style:{width:"150px"}}),e.jsx(p,{header:"Aksi",body:W,style:{width:"120px"}})]})]}),e.jsx(j,{header:"Edit Nama Kamar",visible:D,style:{width:"450px"},onHide:()=>x(!1),footer:e.jsxs("div",{children:[e.jsx(l,{label:"Batal",className:"p-button-text",onClick:()=>x(!1)}),e.jsx(l,{label:"Simpan",className:"p-button-success",onClick:L,disabled:!U.trim()})]}),children:e.jsx("div",{className:"flex flex-col gap-4 pt-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Nama Kamar ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(re,{value:B.name,onChange:a=>T("name",a.target.value),placeholder:"Contoh: Kamar 1",className:"w-full",autoFocus:!0})]})})}),e.jsx(j,{header:`Tambah Peserta ke ${s.name}`,visible:P,style:{width:"600px",maxHeight:"80vh"},onHide:()=>r(!1),footer:e.jsxs("div",{children:[e.jsx(l,{label:"Batal",className:"p-button-text",onClick:()=>r(!1)}),e.jsx(l,{label:`Tambahkan ${t.users.length} Peserta`,className:"p-button-success",onClick:F,disabled:t.users.length===0})]}),children:e.jsxs("div",{className:"flex flex-col gap-4 pt-4",children:[e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsxs("strong",{children:[m.length," orang"]})," sudah berada di kamar ini"]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto rounded-lg border border-gray-200",children:N.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Tidak ada peserta yang belum terplotting"}):N.map(a=>e.jsxs("div",{className:`flex cursor-pointer items-center gap-3 border-b border-gray-100 p-3 hover:bg-gray-50 ${t.users.includes(a.id)?"bg-emerald-50":""}`,onClick:()=>{i("room",s.id),t.users.includes(a.id)?i("users",t.users.filter(n=>n!==a.id)):i("users",[...t.users,a.id])},children:[e.jsx("input",{type:"checkbox",checked:t.users.includes(a.id),onChange:()=>{},className:"h-4 w-4"}),e.jsx(w,{label:a.name.charAt(0),size:"normal",shape:"circle",className:"bg-emerald-600 text-white"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-800",children:a.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a.office.name," • ",a.employment.name]})]})]},a.id))})]})}),e.jsx(j,{header:b?`Pindahkan ${b.name}`:`Pindahkan ${t.users.length} Peserta`,visible:K,style:{width:"500px"},onHide:()=>h(!1),footer:e.jsxs("div",{children:[e.jsx(l,{label:"Batal",className:"p-button-text",onClick:()=>h(!1)}),e.jsx(l,{label:"Pindahkan",className:"p-button-info",onClick:b?I:_,disabled:!t.room})]}),children:e.jsxs("div",{className:"flex flex-col gap-4 pt-4",children:[e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-3",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Dari:"})," ",s.building.name," - ",s.name]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Pindah ke Kamar ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(le,{value:c,options:Z,onChange:a=>{i("users",o),i("room",a.value.id),y(a.value)},placeholder:"Pilih kamar tujuan",className:"w-full",filter:!0})]}),c&&e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["Kamar tujuan dipilih:"," ",e.jsxs("strong",{children:[c.building.name," - ",c.name]})]})})]})})]})};export{Me as default};
