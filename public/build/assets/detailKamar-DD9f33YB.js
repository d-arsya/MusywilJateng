import{r as d,u as C,j as e,a as Y}from"./app-DMqxqPJM.js";import{A as Z}from"./admin-BjmkL1yy.js";import{A as S}from"./avatar.esm-77dLfQQ7.js";import{B as t}from"./button.esm-C0xj6u3o.js";import{D as ee,C as u}from"./datatable.esm-DpbtT2Zb.js";import{C as ae,c as j}from"./confirmdialog.esm-Dzs_Yrkq.js";import{D as N}from"./dialog.esm-BDgGQl6K.js";import{D as se}from"./dropdown.esm-CQUAa7zv.js";import{I as ne}from"./inputtext.esm-CqZLBaoz.js";import{T as le}from"./tag.esm-Df4OKypR.js";import{A as te}from"./arrow-left-lPMXmSKX.js";import{P as re,T as ie}from"./trash-2-CPgK3zN2.js";import{U as oe}from"./users-BhxOVoR-.js";import{U as de}from"./user-plus-CyubbU1V.js";import{c as ce}from"./createLucideIcon-DqFWOxZ4.js";import{U as P}from"./user-x-CzJu0NTZ.js";import{P as me}from"./phone-C8uy8x7M.js";import{B as xe}from"./briefcase-8GDbFY8D.js";/* empty css            */import"./x-DJIJzLN8.js";import"./overlayservice.esm-u3reRXgZ.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],ue=ce("arrow-right-left",he),ze=({room:s,unassignedUsers:v,otherRooms:K})=>{const m=s.users,[D,p]=d.useState(!1),[U,r]=d.useState(!1),[A,x]=d.useState(!1),[b,y]=d.useState(s.name),{delete:B}=C(null),[o,k]=d.useState([]),[f,T]=d.useState(null),[c,w]=d.useState(null),{data:l,setData:i,put:h}=C({users:[],room:s.id}),E=()=>{y(s.name),p(!0)},$=()=>{setRoom({...s,name:b}),p(!1)},z=()=>{m.length>0||j({message:`Apakah Anda yakin ingin menghapus ${s.name}?`,header:"Konfirmasi Hapus",icon:"pi pi-exclamation-triangle",acceptLabel:"Hapus",rejectLabel:"Batal",acceptClassName:"p-button-danger",accept:()=>{B("/admin/penginapan/gedung/"+s.building.name+"/kamar/"+s.id,{onError:a=>{console.log("Validation Errors:",a)},onSuccess:()=>console.log("SUCCESS")})}})},R=()=>{i("users",[]),r(!0)},L=()=>{h("/admin/penginapan/assign",{onSuccess:()=>r(!1),onError:()=>r(!1)})},M=()=>{i("room",c.id),h("/admin/penginapan/assign",{onSuccess:()=>x(!1),onError:a=>console.log(a)})},H=a=>{j({message:`Keluarkan ${a.name} dari ${s.name}?`,header:"Konfirmasi Keluarkan",icon:"pi pi-exclamation-triangle",acceptLabel:"Keluarkan",rejectLabel:"Batal",acceptClassName:"p-button-danger",accept:()=>{k([]),h("/admin/penginapan/unassigned/"+a.code,{onSuccess:()=>{r(!1)},onError:n=>{r(!1)}})}})},F=()=>{o.length!==0&&(T(null),w(null),x(!0))},I=()=>{o.length!==0&&j({message:`Keluarkan ${o.length} peserta dari ${s.name}?`,header:"Konfirmasi Keluarkan",icon:"pi pi-exclamation-triangle",acceptLabel:"Keluarkan",rejectLabel:"Batal",acceptClassName:"p-button-danger",accept:()=>{let a=o.map(n=>n.code);h("/admin/penginapan/unassigned/bulk?code="+a.join(","),{onSuccess:()=>r(!1),onError:n=>{console.log(n)}})}})},O=()=>{!c||l.length===0||(console.log(l),h("/admin/penginapan/assign",{onSuccess:()=>x(!1),onError:a=>console.log(a)}))},J=()=>{Y.get("/admin/penginapan/gedung/"+s.building.name)},_=a=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{label:a.name.charAt(0),size:"large",shape:"circle",className:"bg-emerald-600 text-white"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800",children:a.name}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[e.jsx(me,{size:12}),a.phone]})]})]}),V=a=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{size:14,className:"text-gray-500"}),e.jsxs("span",{className:"text-sm",children:[a.office.type," ",a.office.name]})]}),X=a=>{const n={Pembina:"info",Pengurus:"success",Pengawas:"warning",Anggota:"secondary"};return e.jsx(le,{value:a.employment.name,severity:n[a.employment.name]||"secondary"})},q=a=>e.jsx("div",{className:"flex gap-2",children:e.jsx(t,{icon:e.jsx(P,{size:16}),className:"p-button-rounded p-button-text p-button-danger",onClick:()=>H(a),tooltip:"Keluarkan"})}),G=[...m].sort((a,n)=>{const g=a.name.localeCompare(n.name);return g!==0?g:a.office.name.localeCompare(n.office.name)}),Q=K.map(a=>({label:`${a.building.name} - ${a.name}`,value:a}));return e.jsxs(Z,{children:[e.jsx(ae,{}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:J,className:"mb-4 flex items-center gap-2 text-emerald-600 hover:text-emerald-700",children:[e.jsx(te,{size:20}),e.jsxs("span",{className:"font-medium",children:["Kembali ke ",s.building.name]})]}),e.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{children:"Dashboard"}),e.jsx("span",{children:"›"}),e.jsx("span",{children:s.building.name}),e.jsx("span",{children:"›"}),e.jsx("span",{className:"font-medium text-gray-800",children:s.name})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:[s.building.name," - ",s.name]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(t,{icon:e.jsx(re,{size:16}),label:"Edit",className:"p-button-outlined p-button-sm",onClick:E}),e.jsx(t,{icon:e.jsx(ie,{size:16}),label:"Hapus",className:"p-button-outlined p-button-danger p-button-sm",onClick:z,disabled:m.length>0})]})]})]}),e.jsx("div",{className:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-1",children:e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 text-sm text-gray-600",children:"Jumlah Penghuni"}),e.jsxs("p",{className:"text-3xl font-bold text-emerald-600",children:[m.length," Orang"]})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-emerald-100",children:e.jsx(oe,{className:"text-emerald-600",size:24})})]})})}),e.jsx("div",{className:"mb-6 rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(t,{label:"Tambah Peserta ke Kamar",icon:e.jsx(de,{size:16}),className:"p-button-success",onClick:R}),o.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(t,{label:`Pindahkan ${l.users.length} Peserta`,icon:e.jsx(ue,{size:16}),className:"p-button-info",onClick:F}),e.jsx(t,{label:`Keluarkan ${l.users.length} Peserta`,icon:e.jsx(P,{size:16}),className:"p-button-danger",onClick:I})]})]})}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 p-4",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Daftar Penghuni"})}),e.jsxs(ee,{value:G,selection:o,onSelectionChange:a=>{const n=a.value,g=n.map(W=>W.id);k(n),i("users",g)},dataKey:"id",emptyMessage:"Kamar ini masih kosong. Tambahkan peserta!",className:"text-sm",children:[e.jsx(u,{selectionMode:"multiple",headerStyle:{width:"3rem"}}),e.jsx(u,{field:"name",header:"Nama Peserta",body:_}),e.jsx(u,{field:"office.name",header:"Utusan",body:V}),e.jsx(u,{field:"employment.name",header:"Jabatan",body:X,style:{width:"150px"}}),e.jsx(u,{header:"Aksi",body:q,style:{width:"120px"}})]})]}),e.jsx(N,{header:"Edit Nama Kamar",visible:D,style:{width:"450px"},onHide:()=>p(!1),footer:e.jsxs("div",{children:[e.jsx(t,{label:"Batal",className:"p-button-text",onClick:()=>p(!1)}),e.jsx(t,{label:"Simpan",className:"p-button-success",onClick:$,disabled:!b.trim()})]}),children:e.jsx("div",{className:"flex flex-col gap-4 pt-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Nama Kamar ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ne,{value:b,onChange:a=>y(a.target.value),placeholder:"Contoh: Kamar 1",className:"w-full",autoFocus:!0})]})})}),e.jsx(N,{header:`Tambah Peserta ke ${s.name}`,visible:U,style:{width:"600px",maxHeight:"80vh"},onHide:()=>r(!1),footer:e.jsxs("div",{children:[e.jsx(t,{label:"Batal",className:"p-button-text",onClick:()=>r(!1)}),e.jsx(t,{label:`Tambahkan ${l.users.length} Peserta`,className:"p-button-success",onClick:L,disabled:l.users.length===0})]}),children:e.jsxs("div",{className:"flex flex-col gap-4 pt-4",children:[e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsxs("strong",{children:[m.length," orang"]})," sudah berada di kamar ini"]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto rounded-lg border border-gray-200",children:v.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Tidak ada peserta yang belum terplotting"}):v.map(a=>e.jsxs("div",{className:`flex cursor-pointer items-center gap-3 border-b border-gray-100 p-3 hover:bg-gray-50 ${l.users.includes(a.id)?"bg-emerald-50":""}`,onClick:()=>{i("room",s.id),l.users.includes(a.id)?i("users",l.users.filter(n=>n!==a.id)):i("users",[...l.users,a.id])},children:[e.jsx("input",{type:"checkbox",checked:l.users.includes(a.id),onChange:()=>{},className:"h-4 w-4"}),e.jsx(S,{label:a.name.charAt(0),size:"normal",shape:"circle",className:"bg-emerald-600 text-white"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-800",children:a.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a.office.name," • ",a.employment.name]})]})]},a.id))})]})}),e.jsx(N,{header:f?`Pindahkan ${f.name}`:`Pindahkan ${l.users.length} Peserta`,visible:A,style:{width:"500px"},onHide:()=>x(!1),footer:e.jsxs("div",{children:[e.jsx(t,{label:"Batal",className:"p-button-text",onClick:()=>x(!1)}),e.jsx(t,{label:"Pindahkan",className:"p-button-info",onClick:f?M:O,disabled:!l.room})]}),children:e.jsxs("div",{className:"flex flex-col gap-4 pt-4",children:[e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-3",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Dari:"})," ",s.building.name," - ",s.name]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Pindah ke Kamar ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(se,{value:c,options:Q,onChange:a=>{i("users",o),i("room",a.value.id),w(a.value)},placeholder:"Pilih kamar tujuan",className:"w-full",filter:!0})]}),c&&e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["Kamar tujuan dipilih:"," ",e.jsxs("strong",{children:[c.building.name," - ",c.name]})]})})]})})]})};export{ze as default};
