import{u as D,r as n,j as e,L as I}from"./app-CP-yxF_s.js";import{A as E}from"./admin-D2HtWdQy.js";import{C as K,g as M}from"./index.module-Cpe0IXgn.js";import{U as g}from"./user-DgvffMcF.js";import{U as J}from"./upload-eK_3FzZa.js";import{C as L}from"./circle-alert-siPaoFuB.js";import{P as G}from"./phone-C_S7VU64.js";import{B as R}from"./briefcase-2la9_90o.js";import{C as T}from"./calendar-gUePOcy8.js";import{S as O}from"./save-CQclLTcj.js";import{X as W}from"./x-COaciEEv.js";/* empty css            */import"./createLucideIcon-OogrKs_h.js";function de({employments:b,user:f,offices:j,room:o}){const x=f,{data:l,setData:p,post:y}=D(x),[N,v]=n.useState(x.avatar),[u,Z]=n.useState(!1),[a,m]=n.useState({}),d=s=>{const{name:r,value:t}=s.target;p(r,t)},[h,w]=n.useState(null),[C,c]=n.useState(!1),[k,P]=n.useState({x:0,y:0}),[S,U]=n.useState(1),[_,A]=n.useState(null),$=(s,r)=>A(r),F=s=>{const r=s.target.files?.[0];if(!r)return;if(r.size>2048*1024){m(i=>({...i,avatar:"Ukuran file maksimal 2MB"}));return}if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(r.type)){m(i=>({...i,avatar:"Format file harus JPG, PNG, atau WebP"}));return}const t=new FileReader;t.onload=()=>{w(t.result),c(!0)},t.readAsDataURL(r),m(i=>({...i,avatar:null}))},z=async s=>{console.log(l),s.preventDefault(),y("/admin/peserta/"+l.code,{onError:r=>console.log(r)})},B=()=>{confirm("Batalkan perubahan? Data yang belum disimpan akan hilang.")&&window.history.back()};return e.jsx(E,{children:e.jsx("div",{className:"min-h-screen p-4 md:p-8",children:e.jsxs("div",{className:"mx-auto max-w-4xl",children:[e.jsxs("div",{className:"mb-6 flex flex-col gap-y-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Edit Data Peserta"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Perbarui informasi peserta Muswil VI Hidayatullah"})]}),e.jsxs("div",{className:"flex gap-2 md:justify-end",children:[e.jsx("div",{className:"rounded-lg bg-blue-300 px-4 py-2 hover:bg-blue-400",children:e.jsx(I,{href:`/n/${l.code}`,className:"text-sm font-semibold text-blue-700",children:"Kirim Ke Peserta"})}),e.jsx("div",{className:"rounded-lg bg-emerald-100 px-4 py-2",children:e.jsx("span",{className:"text-sm font-semibold text-emerald-700",children:l.code})})]})]}),e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-lg",children:[e.jsxs("h2",{className:"mb-4 flex items-center text-lg font-semibold text-gray-800",children:[e.jsx(g,{className:"mr-2 h-5 w-5 text-emerald-600"}),"Foto Profil"]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-32 w-32 overflow-hidden rounded-2xl border-4 border-gray-100 shadow-md",children:e.jsx("img",{src:N||"/assets/img/placeholder.webp",alt:"Avatar",className:"h-full w-full object-cover"})}),e.jsx("label",{htmlFor:"avatar-upload",className:"absolute -right-2 -bottom-2 flex h-10 w-10 cursor-pointer items-center justify-center rounded-full bg-emerald-600 text-white shadow-lg transition hover:bg-emerald-700",children:e.jsx(J,{className:"h-5 w-5"})}),e.jsx("input",{id:"avatar-upload",type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:F,className:"hidden"})]}),C&&e.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-black/60",children:[e.jsx("div",{className:"relative h-80 w-80 bg-black",children:e.jsx(K,{image:h,crop:k,zoom:S,aspect:1,onCropChange:P,onZoomChange:U,onCropComplete:$})}),e.jsxs("div",{className:"mt-4 flex gap-4",children:[e.jsx("button",{onClick:()=>c(!1),className:"rounded bg-gray-300 px-4 py-2",children:"Batal"}),e.jsx("button",{onClick:async()=>{const s=await M(h,_);v(s);const t=await(await fetch(s)).blob();p("avatar",t),c(!1)},className:"rounded bg-emerald-600 px-4 py-2 text-white hover:bg-emerald-700",children:"Pilih"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"mb-1 font-medium text-gray-700",children:"Upload foto peserta"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Format: JPG, PNG, WebP (Max 2MB)"}),a.avatar&&e.jsxs("p",{className:"mt-2 flex items-center text-sm text-red-600",children:[e.jsx(L,{className:"mr-1 h-4 w-4"}),a.avatar]})]})]})]}),e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-lg",children:[e.jsxs("h2",{className:"mb-4 flex items-center text-lg font-semibold text-gray-800",children:[e.jsx(g,{className:"mr-2 h-5 w-5 text-emerald-600"}),"Informasi Pribadi"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Nama Lengkap *"}),e.jsx("input",{type:"text",name:"name",value:l.name,onChange:d,className:`w-full rounded-lg border-2 ${a.name?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`,placeholder:"Masukkan nama lengkap"}),a.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Kamar"}),o?e.jsx("input",{type:"text",disabled:!0,value:`${o.building.name} ${o.name}`,className:"w-full rounded-lg border-2 border-gray-200 bg-gray-100 px-4 py-3 transition focus:border-emerald-500 focus:outline-none"}):e.jsx("input",{type:"text",disabled:!0,value:"Belum dapat kamar",className:"w-full rounded-lg border-2 border-gray-200 bg-gray-100 px-4 py-3 transition focus:border-emerald-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 flex items-center text-sm font-medium text-gray-700",children:[e.jsx(G,{className:"mr-1 h-4 w-4"}),"Nomor Telepon *"]}),e.jsx("input",{type:"tel",name:"phone",value:l.phone,onChange:d,className:`w-full rounded-lg border-2 ${a.phone?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`,placeholder:"08xxxxxxxxxx"}),a.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Ukuran Peci *"}),e.jsx("input",{type:"number",name:"capsize",value:l.capsize,onChange:d,className:`w-full rounded-lg border-2 ${a.capsize?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`}),a.capsize&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.capsize})]})]})]}),e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-lg",children:[e.jsxs("h2",{className:"mb-4 flex items-center text-lg font-semibold text-gray-800",children:[e.jsx(R,{className:"mr-2 h-5 w-5 text-emerald-600"}),"Informasi Organisasi"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Utusan *"}),e.jsxs("select",{name:"office_id",value:l.office_id,onChange:d,className:`w-full rounded-lg border-2 ${a.office_id?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`,children:[e.jsx("option",{value:"",children:"Pilih Utusan"}),Object.entries(j).map(([s,r])=>e.jsx("optgroup",{label:s,children:r.map(t=>e.jsxs("option",{value:t.id,children:[t.type," ",t.name]},t.id))},s))]}),a.office_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.office_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Jabatan *"}),e.jsxs("select",{name:"employment_id",value:l.employment_id,onChange:d,className:`w-full rounded-lg border-2 ${a.employment_id?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`,children:[e.jsx("option",{value:"",children:"Pilih Jabatan"}),b.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),a.employment_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.employment_id})]})]})]}),e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-lg",children:[e.jsxs("h2",{className:"mb-4 flex items-center text-lg font-semibold text-gray-800",children:[e.jsx(T,{className:"mr-2 h-5 w-5 text-emerald-600"}),"Jadwal Kehadiran"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Tanggal Kedatangan *"}),e.jsx("input",{type:"date",name:"arrive",value:l.arrive,onChange:d,className:`w-full rounded-lg border-2 ${a.arrive?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`}),a.arrive&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.arrive})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Tanggal Kepulangan *"}),e.jsx("input",{type:"date",name:"depart",value:l.depart,onChange:d,className:`w-full rounded-lg border-2 ${a.depart?"border-red-300":"border-gray-200"} px-4 py-3 transition focus:border-emerald-500 focus:outline-none`}),a.depart&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.depart})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"submit",disabled:u,className:"flex flex-1 items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-emerald-600 to-teal-600 px-6 py-4 font-semibold text-white shadow-lg transition hover:shadow-xl disabled:cursor-not-allowed disabled:opacity-50",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-5 w-5"}),"Simpan Perubahan"]})}),e.jsxs("button",{type:"button",onClick:B,className:"flex items-center justify-center gap-2 rounded-xl border-2 border-gray-300 bg-white px-6 py-4 font-semibold text-gray-700 transition hover:bg-gray-50",children:[e.jsx(W,{className:"h-5 w-5"}),"Batal"]})]})]})]})})})}export{de as default};
