import{r as s,u as q,j as r}from"./app-BTNgAOou.js";import{P as k}from"./public-lSSrQ_hM.js";import{C as z,g as R}from"./index.module-ChcnSJpB.js";/* empty css            */import"./header-Bs34rZ2z.js";import"./x-C5v1QP9Q.js";import"./createLucideIcon-hjrDhcHa.js";function T({offices:d,employments:u}){const[D,E]=s.useState(null),{data:t,setData:n,post:p,transform:m}=q({name:"",phone:"",office:"",employment:"",arrive:"",depart:"",capsize:"",avatar:null}),[i,g]=s.useState(null),[f,h]=s.useState({x:0,y:0}),[x,b]=s.useState(1),[v,j]=s.useState(null),[y,l]=s.useState(!1),[c,w]=s.useState(null);m(e=>({...e,employment_id:e.employment,office_id:e.office,phone:e.phone.startsWith("0")?"62"+e.phone.slice(1):e.phone}));function N(e){e.preventDefault(),p("/register",{onError:a=>{console.log(t),console.log("Validation Errors:",a)},onSuccess:()=>console.log("SUCCESS")})}const C=(e,a)=>{j(a)},P=e=>{if(e.target.files&&e.target.files[0]){const a=new FileReader;a.onload=()=>{w(a.result),l(!0)},a.readAsDataURL(e.target.files[0])}},S=async()=>{const e=await R(c,v);g(e);const o=await(await fetch(e)).blob();n("avatar",o),l(!1)};return r.jsx(k,{children:r.jsxs("form",{onSubmit:N,className:"w-full max-w-2xl space-y-6 overflow-auto rounded-xl border border-gray-200 bg-white p-8 shadow-xl",children:[r.jsx("h1",{className:"text-center text-3xl font-bold text-emerald-800",children:"Registrasi Peserta"}),r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsxs("label",{className:"flex h-32 w-32 cursor-pointer items-center justify-center overflow-hidden rounded-full border-2 border-dashed border-emerald-400",children:[i?r.jsx("img",{src:i,alt:"Preview",className:"h-full w-full object-cover"}):r.jsx("span",{className:"text-center text-sm text-emerald-400",children:"Upload Foto"}),r.jsx("input",{required:!0,type:"file",accept:"image/*",className:"hidden",onChange:P})]}),y&&r.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-black/60",children:[r.jsx("div",{className:"relative h-80 w-80 bg-black",children:r.jsx(z,{image:c,crop:f,zoom:x,aspect:1,onCropChange:h,onZoomChange:b,onCropComplete:C})}),r.jsxs("div",{className:"mt-4 flex gap-4",children:[r.jsx("button",{onClick:()=>l(!1),className:"rounded bg-gray-300 px-4 py-2",children:"Batal"}),r.jsx("button",{onClick:S,className:"rounded bg-emerald-500 px-4 py-2 text-white",children:"Pilih"})]})]})]}),r.jsx("input",{required:!0,value:t.name,onChange:e=>n("name",e.target.value),type:"text",placeholder:"Nama Lengkap",className:"w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-700 transition duration-200 focus:ring-2 focus:ring-emerald-500 focus:outline-none"}),r.jsx("input",{required:!0,value:t.phone,onChange:e=>n("phone",e.target.value),type:"tel",placeholder:"Nomor HP",className:"w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-700 transition duration-200 focus:ring-2 focus:ring-emerald-500 focus:outline-none"}),r.jsxs("select",{required:!0,value:t.office,onChange:e=>n("office",e.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-3 transition duration-200 focus:ring-2 focus:ring-emerald-500 focus:outline-none",children:[r.jsx("option",{value:"",children:"Pilih Utusan"}),Object.entries(d).map(([e,a])=>r.jsx("optgroup",{label:e,children:a.map(o=>r.jsx("option",{value:o.id,children:o.name},o.id))},e))]}),r.jsxs("select",{required:!0,value:t.employment,onChange:e=>n("employment",e.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-3 transition duration-200 focus:ring-2 focus:ring-emerald-500 focus:outline-none",children:[r.jsx("option",{value:"",children:"Pilih Jabatan"}),u.map(e=>r.jsx("option",{value:e.id,children:e.name}))]}),r.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[r.jsxs("div",{className:"",children:[r.jsx("h1",{className:"mb-2",children:"Kedatangan"}),r.jsx("input",{required:!0,value:t.arrive,onChange:e=>n("arrive",e.target.value),type:"date",placeholder:"Tanggal Kedatangan",className:"w-full rounded-lg border border-gray-300 px-4 py-3 transition duration-200 focus:ring-2 focus:ring-emerald-500 focus:outline-none"})]}),r.jsxs("div",{className:"",children:[r.jsx("h1",{className:"mb-2",children:"Kepulangan"}),r.jsx("input",{required:!0,value:t.depart,onChange:e=>n("depart",e.target.value),type:"date",placeholder:"Tanggal Kepulangan",className:"w-full rounded-lg border border-gray-300 px-4 py-3 transition duration-200 focus:ring-2 focus:ring-emerald-500 focus:outline-none"})]})]}),r.jsxs("select",{required:!0,value:t.capsize,onChange:e=>n("capsize",e.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-3 transition duration-200 focus:ring-2 focus:ring-emerald-500 focus:outline-none",children:[r.jsx("option",{value:"",children:"Pilih Ukuran Peci"}),[...Array(8)].map((e,a)=>{const o=a+5;return r.jsx("option",{value:o,children:o},o)})]}),r.jsx("button",{type:"submit",className:"w-full rounded-lg bg-emerald-700 py-3 font-semibold text-white transition duration-200 hover:bg-emerald-600",children:"Daftar"})]})})}export{T as default};
