import{r as n,j as e,a as F}from"./app-eX7kheZD.js";import{A as _}from"./admin-B57VrwV5.js";import{A as J}from"./avatar.esm-BVRuRwJX.js";import{B as N}from"./button.esm-DpLtMjKA.js";import{D as G,C as o}from"./datatable.esm-Cm9OORvH.js";import{D as I}from"./dialog.esm-CjrfPSmI.js";import{D as d}from"./dropdown.esm-DNcup8uJ.js";import{I as M}from"./inputtext.esm-DimNZNv7.js";import{T as Q}from"./tag.esm-b4AnBK55.js";import{A as H}from"./arrow-left-2NBX1cOv.js";import{U as q}from"./users-DZ0y7S61.js";import{D as V}from"./door-open-2uIbcfSx.js";import{P as W}from"./phone-gGRU7r2v.js";import{B as X}from"./briefcase-C267OCGc.js";/* empty css            */import"./x-CGCTdwKR.js";import"./createLucideIcon-Cx8o6XcI.js";import"./overlayservice.esm-DnrJ0Fdd.js";const pe=({users:c,employments:v,buildings:f,offices:y})=>{const[w,x]=n.useState(!1),[l,j]=n.useState([]),[m,k]=n.useState(""),[h,C]=n.useState(null),[g,P]=n.useState(null),[i,S]=n.useState(null),[r,b]=n.useState(null),[u,A]=n.useState([]),T=()=>{F.get("/admin/penginapan")},B=s=>{S(s),A(s?s.rooms:[]),b(null)},D=()=>{if(!r)return;const a=f.find(t=>t.id===i.id).rooms.find(t=>t.id===r.id);a.users_count+=l.length,setUsers(c.filter(t=>!l.includes(t.id))),j([]),x(!1),alert(`Berhasil assign ${l.length} peserta ke ${i.name} - ${r.name}`)},U=s=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{label:s.name.charAt(0),size:"large",shape:"circle",className:"bg-orange-600 text-white"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[e.jsx(W,{size:12}),s.phone]})]})]}),O=s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{size:14,className:"text-gray-500"}),e.jsx("span",{className:"text-sm",children:s.office.name})]}),$=s=>{const a={Pembina:"info",Pengurus:"success",Pengawas:"warning",Anggota:"secondary"};return e.jsx(Q,{value:s.employment.name,severity:a[s.employment.name]||"secondary"})},p=c.filter(s=>{const a=s.name.toLowerCase().includes(m.toLowerCase())||s.phone.includes(m)||s.office.name.toLowerCase().includes(m.toLowerCase()),t=!h||s.office.id===h.id,E=!g||s.employment.id===g.id;return a&&t&&E}).sort((s,a)=>{const t=s.name.localeCompare(a.name);return t!==0?t:s.office.name.localeCompare(a.office.name)}),z=f.map(s=>({label:`${s.name} (${s.rooms.length} kamar)`,value:s})),K=u.map(s=>({label:`${s.name} (${s.users_count} orang)`,value:s})),L=y.map(s=>({label:s.name,value:s})),R=v.map(s=>({label:s.name,value:s}));return e.jsxs(_,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:T,className:"mb-4 flex items-center gap-2 text-emerald-600 hover:text-emerald-700",children:[e.jsx(H,{size:20}),e.jsx("span",{className:"font-medium",children:"Kembali ke Dashboard"})]}),e.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{children:"Dashboard"}),e.jsx("span",{children:"â€º"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Peserta Belum Terplotting"})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Peserta Belum Terplotting"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Daftar peserta yang belum mendapatkan kamar penginapan"})]}),e.jsx("div",{className:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-1",children:e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 text-sm text-gray-600",children:"Total Belum Terplotting"}),e.jsxs("p",{className:"text-3xl font-bold text-orange-600",children:[c.length," Peserta"]})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-orange-100",children:e.jsx(q,{className:"text-orange-600",size:24})})]})})}),e.jsx("div",{className:"mb-6 rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Cari Peserta"}),e.jsx("span",{className:"p-input-icon-left w-full",children:e.jsx(M,{placeholder:"Nama, telepon, atau utusan...",value:m,onChange:s=>k(s.target.value),className:"w-full"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Filter Utusan"}),e.jsx(d,{value:h,options:L,onChange:s=>C(s.value),placeholder:"Semua Utusan",className:"w-full",showClear:!0,filter:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Filter Jabatan"}),e.jsx(d,{value:g,options:R,onChange:s=>P(s.value),placeholder:"Semua Jabatan",className:"w-full",showClear:!0})]})]})}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 p-4",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Daftar Peserta (",p.length,")"]})}),e.jsxs(G,{value:p,selection:p.filter(s=>l.includes(s.id)),onSelectionChange:s=>j(s.value.map(a=>a.id)),dataKey:"id",emptyMessage:"Tidak ada peserta yang belum terplotting",paginator:!0,rows:10,rowsPerPageOptions:[10,25,50],className:"text-sm",children:[e.jsx(o,{selectionMode:"multiple",headerStyle:{width:"3rem"}}),e.jsx(o,{field:"name",header:"Nama Peserta",body:U}),e.jsx(o,{field:"office.name",header:"Utusan",body:O}),e.jsx(o,{field:"employment.name",header:"Jabatan",body:$,style:{width:"150px"}})]})]}),e.jsx(I,{header:l.length===1?"Assign Peserta ke Kamar":`Assign ${l.length} Peserta ke Kamar`,visible:w,style:{width:"550px"},onHide:()=>x(!1),footer:e.jsxs("div",{children:[e.jsx(N,{label:"Batal",className:"p-button-text",onClick:()=>x(!1)}),e.jsx(N,{label:"Assign ke Kamar",className:"p-button-success",onClick:D,disabled:!r})]}),children:e.jsxs("div",{className:"flex flex-col gap-4 pt-4",children:[l.length>1&&e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsxs("strong",{children:[l.length," peserta"]})," akan di-assign ke kamar yang sama"]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["1. Pilih Gedung ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{value:i,options:z,onChange:s=>B(s.value),placeholder:"Pilih gedung",className:"w-full",filter:!0})]}),i&&e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["2. Pilih Kamar ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{value:r,options:K,onChange:s=>b(s.value),placeholder:"Pilih kamar",className:"w-full",disabled:u.length===0,filter:!0}),u.length===0&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:"Gedung ini belum memiliki kamar. Tambahkan kamar terlebih dahulu."})]}),r&&e.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-emerald-100",children:e.jsx(V,{className:"text-emerald-600",size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"mb-1 font-semibold text-emerald-800",children:[i.name," - ",r.name]}),e.jsxs("p",{className:"text-sm text-emerald-700",children:["Saat ini: ",e.jsxs("strong",{children:[r.users_count," orang"]})]}),e.jsxs("p",{className:"text-sm text-emerald-700",children:["Setelah assign: ",e.jsxs("strong",{children:[r.users_count+l.length," orang"]})]})]})]})})]})})]})};export{pe as default};
